(()=>{"use strict";var e={591:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createNewNoteHTML=t.CreateHTMLFromNote=t.SetHTMLClasses=void 0;const n=o(927),r=o(716),a=o(79);t.SetHTMLClasses=(e,t)=>{e.trashIconHTML.className="",e.noteIconHTML.className="",e.textAreaHTML.className="",e.wrapperHTML.className="",e.wrapperHTML.style.cssText="",e.wrapperHTML.classList.add(`Note${(0,n.GetPageNotes)().length}`),t===r.ENoteOverlayStyle.sidebar?(e.trashIconHTML.classList.add("noteTrashIconSideBar"),e.noteIconHTML.classList.add("noteDisplayIconSideBar"),e.textAreaHTML.classList.add("noteTextAreaSideBar"),e.wrapperHTML.classList.add("noteWrapperElementSideBar")):(e.trashIconHTML.classList.add("noteTrashIcon"),e.noteIconHTML.classList.add("noteDisplayIcon"),e.textAreaHTML.classList.add("noteTextArea"),e.wrapperHTML.classList.add("noteWrapperElement"),e.wrapperHTML.style.width=e.width,e.wrapperHTML.style.height=e.height,e.wrapperHTML.style.left=e.left),e.wrapperHTML.style.top=e.top},t.CreateHTMLFromNote=e=>{const o=document.createElement("div"),n=document.createElement("button"),l=document.createElement("button"),s=document.createElement("textarea");return s.value=e.content,l.addEventListener("click",(()=>{(0,a.deleteNote)(e)})),n.addEventListener("click",(()=>{const e=s.classList.contains("closedOverlay");(0,a.toggleNote)(s,e)})),s.addEventListener("change",(t=>{s.innerHTML=t.target.value,e.content=s.innerHTML})),o.appendChild(n),o.appendChild(l),o.appendChild(s),e.noteIconHTML=n,e.textAreaHTML=s,e.trashIconHTML=l,e.wrapperHTML=o,(0,t.SetHTMLClasses)(e,(0,r.GetCurrentNoteOverlayStyle)()),e},t.createNewNoteHTML=(e,o,n,l,s)=>{let i;const d=document.createElement("div"),c=document.createElement("button"),p=document.createElement("button"),g=document.createElement("textarea");return g.value=s||"Enter your note here",p.addEventListener("click",(()=>{(0,a.deleteNote)(i)})),c.addEventListener("click",(()=>{const e=g.classList.contains("closedOverlay");(0,a.toggleNote)(g,e)})),g.addEventListener("change",(e=>{g.innerHTML=e.target.value,i.content=g.innerHTML})),d.appendChild(c),d.appendChild(p),d.appendChild(g),i={width:e,height:o,top:l,left:n,content:g.value,wrapperHTML:d,textAreaHTML:g,noteIconHTML:c,trashIconHTML:p,initialScrollPosition:window.scrollY},(0,t.SetHTMLClasses)(i,(0,r.GetCurrentNoteOverlayStyle)()),i}},79:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertAbsoluteToRelativePosition=t.calculateNoteWidthInPx=t.calculateNoteHeightInPx=t.createNoteForSelectedText=t.setAllNotesDisplay=t.toggleNote=t.deleteNote=t.SetAreNotesShowing=t.GetAreNotesShowing=void 0;const n=o(591),r=o(927),a=o(716);let l=!1;t.GetAreNotesShowing=()=>l,t.SetAreNotesShowing=e=>{l=e,(0,r.sendCurrentNoteStatusToBackend)()},t.deleteNote=e=>{if(void 0===e)return;const t=(0,r.GetPageNotes)().indexOf(e);(0,r.GetPageNotes)().splice(t,1),e.wrapperHTML.remove()},t.toggleNote=(e,t)=>{void 0!==e&&(t?e.classList.remove("closedOverlay"):e.classList.add("closedOverlay"))},t.setAllNotesDisplay=e=>{if((0,a.GetCurrentNoteOverlayStyle)()===a.ENoteOverlayStyle.sidebar)(0,a.ToggleSideBar)(e);else{const o=(0,r.GetPageNotes)();if(o.length<=0)return;for(const n of o)(0,t.toggleNote)(n.textAreaHTML,e)}},t.createNoteForSelectedText=()=>{var e;if(window.getSelection){const o=window.getSelection();if(o&&o.rangeCount){const l=o.getRangeAt(0).startContainer.parentElement;let s=null===(e=o.getRangeAt(0).endContainer)||void 0===e?void 0:e.parentElement;if(s||(s=o.getRangeAt(0).startContainer.parentElement),!l||!s)return;const i=(0,t.calculateNoteWidthInPx)(l,s),d=(0,t.calculateNoteHeightInPx)(l,s),c=l.getBoundingClientRect().left+window.scrollX+"px",p=(0,a.GetCurrentNoteOverlayStyle)()===a.ENoteOverlayStyle.sidebar?l.getBoundingClientRect().top+"px":l.getBoundingClientRect().top+window.scrollY+"px",g=(0,n.createNewNoteHTML)(i,d,c,p,"");g.initialScrollPosition=window.scrollY,g.startContainerHTML=l,g.endContainerHTML=s,(0,r.GetPageNotes)().push(g),(0,a.GetCurrentNoteOverlayStyle)()===a.ENoteOverlayStyle.sidebar?(0,a.GetSideBar)().appendChild(g.wrapperHTML):document.body.appendChild(g.wrapperHTML)}}return null},t.calculateNoteHeightInPx=(e,t)=>{const o=e.getBoundingClientRect().top+window.scrollY;return t.getBoundingClientRect().bottom+window.scrollY-o+"px"},t.calculateNoteWidthInPx=(e,t)=>{const o=e.getBoundingClientRect().width,n=t.getBoundingClientRect().width;return Math.max(o,n)+"px"},t.convertAbsoluteToRelativePosition=(e,t)=>e-t.getBoundingClientRect().top},853:(e,t)=>{var o;Object.defineProperty(t,"__esModule",{value:!0}),t.EMessageTypes=void 0,function(e){e[e.overlay=0]="overlay",e[e.sidebar=1]="sidebar",e[e.create=2]="create",e[e.toggleNoteVisibility=3]="toggleNoteVisibility",e[e.updateIsNoteShowing=4]="updateIsNoteShowing",e[e.none=5]="none"}(o||(t.EMessageTypes=o={}))},927:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(r,a){function l(e){try{i(n.next(e))}catch(e){a(e)}}function s(e){try{i(n.throw(e))}catch(e){a(e)}}function i(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(l,s)}i((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.pageNotes=t.sendCurrentNoteStatusToBackend=t.GetPageNotes=void 0;const r=o(591),a=o(716),l=o(79),s=o(853),i=[];t.pageNotes=i,t.GetPageNotes=()=>i,t.sendCurrentNoteStatusToBackend=()=>n(void 0,void 0,void 0,(function*(){return chrome.runtime.sendMessage(JSON.stringify({type:s.EMessageTypes.updateIsNoteShowing,result:(0,l.GetAreNotesShowing)()}))})),chrome.runtime.onMessage.addListener(((e,o,n)=>{const r=JSON.parse(e);if(r.type===s.EMessageTypes.overlay)(0,a.ChangeOverlayStyle)(a.ENoteOverlayStyle.overlay);else if(r.type===s.EMessageTypes.sidebar)(0,a.ChangeOverlayStyle)(a.ENoteOverlayStyle.sidebar);else if(r.type===s.EMessageTypes.create)(0,l.createNoteForSelectedText)();else if(r.type===s.EMessageTypes.toggleNoteVisibility)return(0,l.SetAreNotesShowing)(!(0,l.GetAreNotesShowing)()),(0,a.GetCurrentNoteOverlayStyle)()===a.ENoteOverlayStyle.sidebar?(0,a.ToggleSideBar)((0,l.GetAreNotesShowing)()):(0,l.setAllNotesDisplay)((0,l.GetAreNotesShowing)()),(0,t.sendCurrentNoteStatusToBackend)().then((()=>{n()})),!0})),window.onbeforeunload=function(){if(localStorage.removeItem("Notes"),i.length>0){setTimeout((()=>{}),1e3);const e=[];for(const t of i)e.push(JSON.stringify(t));localStorage.setItem("Notes",JSON.stringify(e))}},window.onload=()=>{const e=localStorage.getItem("Notes");if(e){const o=JSON.parse(e);for(const e of o){console.log(e);let o=JSON.parse(e);o=(0,r.CreateHTMLFromNote)(o),(0,t.GetPageNotes)().push(o),(0,a.GetCurrentNoteOverlayStyle)()===a.ENoteOverlayStyle.sidebar?(0,a.GetSideBar)().appendChild(o.wrapperHTML):document.body.appendChild(o.wrapperHTML)}}(0,t.sendCurrentNoteStatusToBackend)()}},716:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ToggleSideBar=t.ChangeOverlayStyle=t.GetCurrentNoteOverlayStyle=t.GetSideBar=t.ENoteOverlayStyle=void 0;const n=o(591),r=o(927),a=o(79),l=o(926);var s;let i,d;!function(e){e[e.overlay=0]="overlay",e[e.sidebar=1]="sidebar"}(s||(t.ENoteOverlayStyle=s={}));let c=s.sidebar;t.GetSideBar=()=>(i||(i=document.createElement("div"),i.classList.add("NoteSideBar"),d=document.createElement("div"),i.appendChild(d),d.classList.add("NoteSidebarButton"),d.addEventListener("click",(()=>{(0,a.SetAreNotesShowing)(!(0,a.GetAreNotesShowing)()),(0,t.ToggleSideBar)((0,a.GetAreNotesShowing)())})),d.innerHTML="N\nO\nT\nE\nS",c===s.overlay&&((0,t.ToggleSideBar)(!0),d.style.display="none"),document.body.appendChild(i)),i),t.GetCurrentNoteOverlayStyle=()=>c,t.ChangeOverlayStyle=e=>{c=e,c===s.overlay?((0,t.ToggleSideBar)(!1),d.style.display="none"):((0,t.ToggleSideBar)(!0),d.style.display="block");for(const o of(0,r.GetPageNotes)())(0,n.SetHTMLClasses)(o,(0,t.GetCurrentNoteOverlayStyle)()),e===s.overlay?document.body.appendChild(o.wrapperHTML):(0,t.GetSideBar)().appendChild(o.wrapperHTML);(0,l.ResizeAllElements)()},t.ToggleSideBar=e=>{e?(0,t.GetSideBar)().classList.remove("closed"):(0,t.GetSideBar)().classList.add("closed")}},926:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ResizeAllElements=void 0;const n=o(927),r=o(716),a=o(79);t.ResizeAllElements=()=>{if(!((0,n.GetPageNotes)().length<=0))for(const e of(0,n.GetPageNotes)()){if(!e.startContainerHTML||!e.endContainerHTML)continue;const t=(0,r.GetCurrentNoteOverlayStyle)()===r.ENoteOverlayStyle.sidebar?e.startContainerHTML.getBoundingClientRect().top+"px":e.startContainerHTML.getBoundingClientRect().top+window.scrollY+"px";if(e.wrapperHTML.style.top=t,(0,r.GetCurrentNoteOverlayStyle)()===r.ENoteOverlayStyle.sidebar)continue;const o=(0,a.calculateNoteHeightInPx)(e.startContainerHTML,e.endContainerHTML),n=(0,a.calculateNoteWidthInPx)(e.startContainerHTML,e.endContainerHTML),l=e.startContainerHTML.getBoundingClientRect().left+window.scrollX+"px";e.wrapperHTML.style.left=l,e.wrapperHTML.style.width=n,e.wrapperHTML.style.height=o}},addEventListener("resize",(()=>{(0,t.ResizeAllElements)()})),addEventListener("scroll",(()=>{(()=>{if((0,r.GetCurrentNoteOverlayStyle)()===r.ENoteOverlayStyle.overlay)return;const e=(0,n.GetPageNotes)();for(const t of e){if(!t.startContainerHTML||!t.endContainerHTML)continue;const e=parseInt(t.top)+(t.initialScrollPosition-window.scrollY);(0,a.convertAbsoluteToRelativePosition)(e,(0,r.GetSideBar)()),t.wrapperHTML.style.top=e+"px"}})()}))}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,o),a.exports}o(927),o(79),o(926),o(716),o(591),o(853)})();
//# sourceMappingURL=content.js.map